{% extends "bird_base_content.html" %}
{% load wagtailcore_tags wagtailsearchpromotions_tags wagtailimages_tags %}


{% block content %}
<div class="content {{ page.specific.content_class|default:'' }}">

    {% if page.specific.show_breadcrumbs %}
    <div class="breadcrumbs_wraper">
        <div class="breadcrumbs">
            {% for ancestor in page.get_ancestors.public|slice:"2:" %}
            <a href="{% pageurl ancestor %}">{{ ancestor.title }}</a> /
            {% endfor %}
            {{ page.title  }}
        </div>
    </div>
    {% endif %}
    
    <div class="search">
        <form action="." method="POST">
            {% csrf_token %}
            {{ form.non_field_errors }}
            {{ form.search_query.errors }}
            <input type="text" id="id_search_query" name="search_query" 
                required="" placeholder="Search">
        </form>
    </div>
    
    {% get_search_promotions search_query as search_promotions %}
    {% if search_promotions %}
    <div class="search_result">
        <ul>
            {% for search_promotion in search_promotions %}
                <li>
                    <a href="{% pageurl search_promotion.page %}">
                        {% if search_promotion.page.specific.cover_image %}
                        {% image search_promotion.page.specific.cover_image original as tmp_photo %}
                        <div class="search_result_item_cover">
                            <img src="{{ tmp_photo.url }}" alt="{{ tmp_photo.alt }}" class="cover_image" />
                        </div>
                        {% endif %}
                        <h3>{{ search_promotion.page.title }}</h3>
                    </a>
                </li>
            {% endfor %}
        </ul>
    </div>
    {% endif %}

    {% if search_results %}
    <div class="search_result">
        <ul>
            {% for result in search_results %}
                <li>
                    <a href="{% pageurl result %}">
                        {% if result.specific.cover_image %}
                        {% image result.specific.cover_image original as tmp_photo %}
                        <div class="search_result_item_cover">
                            <img src="{{ tmp_photo.url }}" alt="{{ tmp_photo.alt }}" class="cover_image" />
                        </div>
                        {% endif %}
                        <h3>{{ result.title }}</h3>
                    </a>
                </li>
            {% endfor %}
        </ul>
    </div>
    {% endif %}
    
</div>
{% endblock %}